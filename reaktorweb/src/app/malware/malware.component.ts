import { HttpClient } from '@angular/common/http';
import { Component, OnInit } from '@angular/core';
import { Malware } from '../computer-dto';
import { FormsModule } from '@angular/forms';


@Component({
  selector: 'app-malware',
  templateUrl: './malware.component.html',
  styleUrls: ['./malware.component.css']
})
export class MalwareComponent implements OnInit{
  nombreInput: string = '';
  descripcionInput: string = '';
  malwares: Malware[] = [];


  constructor(private http: HttpClient) { }

  ngOnInit(): void {
    this.obtenerMalwares();
  }

  obtenerMalwares(): void {
    this.http.get<Malware[]>('http://localhost:8084/malware').subscribe(
      malwares => this.malwares = malwares,
      error => console.error(error)
    );
  }

  eliminarMalware(name: string): void {
    this.http.delete(`http://localhost:8084/malware/${name}`).subscribe(
      () => this.obtenerMalwares(),
      error => console.error(error)
    );
  }


  crearMalware(): void {
    const nuevoMalware: Malware = {
      name: this.nombreInput,
      description: this.descripcionInput
    };

    this.http.post('http://localhost:8084/malware', nuevoMalware).subscribe(
      () => {
        this.nombreInput = '';
        this.descripcionInput = '';
        this.obtenerMalwares();
      },
      error => console.error(error)
    );
  }
}
